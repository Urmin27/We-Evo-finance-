<!DOCTYPE html>
<html lang="mg">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EVO Finance Service - Cartoon Style</title>
  <style>
    /* Import Google Font */
    @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@300;400;700&display=swap');

    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Comic Neue', sans-serif;
      background: linear-gradient(135deg, #ffccff, #cceeff);
      color: #333;
      padding: 20px;
    }
    header {
      text-align: center;
      padding: 20px 0;
      background-color: #ffe6ff;
      border-bottom: 4px solid #ff99cc;
      animation: fadeInDown 1s ease-out;
    }
    header h1 { font-size: 2.5rem; color: #cc0066; }
    section h2 {
      font-size: 2rem;
      margin: 20px 0;
      color: #cc0066;
      text-align: center;
    }
    .account-info {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }
    .account-info div {
      background: #fff;
      padding: 15px 20px;
      border-radius: 10px;
      box-shadow: 3px 3px 10px rgba(0,0,0,0.2);
      transition: transform 0.3s;
    }
    .account-info div:hover { transform: scale(1.05); }
    button, .link-button, .customer-service-btn {
      background-color: #ff99cc;
      border: none;
      color: #fff;
      padding: 10px 20px;
      margin: 10px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.3s, transform 0.3s;
    }
    button:hover, .link-button:hover, .customer-service-btn:hover {
      background-color: #cc0066;
      transform: scale(1.05);
    }
    form {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      margin: 20px auto;
      max-width: 500px;
      box-shadow: 3px 3px 10px rgba(0,0,0,0.2);
      animation: popIn 0.5s ease-out;
    }
    form label { display: block; margin-bottom: 5px; color: #cc0066; font-weight: bold; }
    form input, form select {
      width: 100%;
      padding: 8px;
      margin-bottom: 15px;
      border: 2px solid #ff99cc;
      border-radius: 5px;
      outline: none;
      transition: border-color 0.3s;
    }
    form input:focus, form select:focus { border-color: #cc0066; }
    .modal {
      display: none; position: fixed; z-index: 999;
      left: 0; top: 0; width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.6);
    }
    .modal-content {
      margin: 5% auto; display: block; max-width: 90%;
      border: 5px solid #ff99cc; border-radius: 10px;
      animation: scaleUp 0.5s ease-out;
    }
    .close {
      position: absolute; top: 20px; right: 35px;
      color: #fff; font-size: 40px; font-weight: bold; cursor: pointer;
    }
    .notification {
      position: fixed; top: 20px; right: 20px;
      background: #cc0066; color: #fff;
      padding: 10px 20px; border-radius: 5px;
      z-index: 1000; animation: fadeIn 0.5s ease-out;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes popIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    @keyframes scaleUp { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }
    .profile-header { position: relative; margin: 20px auto; max-width: 800px; }
    .cover-photo img { width: 100%; border-radius: 10px; animation: popIn 0.5s ease-out; }
    .profile-photo-container {
      position: absolute; bottom: -50px; left: 50%;
      transform: translateX(-50%); border: 5px solid #fff;
      border-radius: 50%; overflow: hidden; width: 100px; height: 100px;
      background: #fff; box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }
    .profile-photo img { width: 100%; height: 100%; object-fit: cover; animation: popIn 0.5s ease-out; }
    .customer-service-btn {
      position: fixed; bottom: 20px; right: 20px;
      background: #cc0066; color: #fff; padding: 15px; border-radius: 50%; z-index: 1000;
    }
    .historique-item {
      background: #fff;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
    }
    
    
    
    /* Container an'ny extra sections */
#extra-sections {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 20px;
  padding: 20px;
  background: #f7f7f7;
}

/* Style an'ny bokotra rohy */
.link-button {
  position: relative;
  display: inline-block;
  padding: 12px 30px;
  font-size: 16px;
  font-weight: 600;
  color: #fff;
  text-decoration: none;
  background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
  border-radius: 50px;
  transition: all 0.3s ease-in-out;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  overflow: hidden;
}

/* Overlay animated amin'ny hover */
.link-button::before {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) rotate(45deg);
  width: 0;
  height: 300%;
  background: rgba(255, 255, 255, 0.2);
  transition: width 0.3s ease-in-out;
}

/* Hover effect */
.link-button:hover::before {
  width: 150%;
}

.link-button:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
}

/* Fampifanarahana amin'ny efijery kely */
@media (max-width: 600px) {
  .link-button {
    padding: 10px 20px;
    font-size: 14px;
  }
}

















/* Style an'ny Section Enregistrement & Vérification CIN */
h2 {
  text-align: center;
  color: #333;
  font-size: 24px;
  margin-bottom: 20px;
}

/* Style an'ny container */
#form-registration-cin,
#form-verification-cin {
  width: 90%;
  max-width: 400px;
  background: #ffffff;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.2);
  margin: 0 auto;
  transition: all 0.3s ease-in-out;
}

/* Hover effect amin'ny formulaire */
#form-registration-cin:hover,
#form-verification-cin:hover {
  transform: translateY(-5px);
  box-shadow: 0px 10px 20px rgba(0, 0, 0, 0.3);
}

/* Style an'ny labels */
label {
  display: block;
  margin: 10px 0 5px;
  font-weight: bold;
  color: #555;
}

/* Style an'ny input */
input {
  width: 100%;
  padding: 12px;
  border: 2px solid #ddd;
  border-radius: 6px;
  font-size: 16px;
  margin-bottom: 15px;
  transition: border-color 0.3s ease-in-out;
}

/* Hover & Focus effect amin'ny input */
input:focus {
  border-color: #6a11cb;
  outline: none;
  box-shadow: 0px 0px 5px rgba(106, 17, 203, 0.5);
}

/* Style an'ny bokotra */
button {
  width: 100%;
  background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
  color: white;
  border: none;
  padding: 14px;
  font-size: 18px;
  font-weight: bold;
  border-radius: 30px;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  position: relative;
  overflow: hidden;
}

/* Animated overlay amin'ny bokotra */
button::before {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) rotate(45deg);
  width: 0;
  height: 300%;
  background: rgba(255, 255, 255, 0.2);
  transition: width 0.3s ease-in-out;
}

button:hover::before {
  width: 150%;
}

button:hover {
  transform: translateY(-3px);
  box-shadow: 0px 8px 15px rgba(0, 0, 0, 0.3);
}

/* Responsive */
@media (max-width: 600px) {
  #form-registration-cin,
  #form-verification-cin {
    width: 95%;
  }

  button {
    font-size: 16px;
    padding: 12px;
  }
}














/* Main container */
.container {
  width: 90%;
  max-width: 900px;
  background: #ffffff;
  padding: 30px;
  border-radius: 15px;
  box-shadow: 0px 10px 30px rgba(0, 0, 0, 0.2);
  display: flex;
  justify-content: space-between;
  gap: 20px;
  transition: all 0.3s ease-in-out;
}

/* Hover effect amin'ny container */
.container:hover {
  transform: translateY(-5px);
  box-shadow: 0px 15px 35px rgba(0, 0, 0, 0.3);
}

/* Forms */
.form-section {
  width: 48%;
  padding: 20px;
  border-radius: 10px;
  background: #f9f9f9;
  box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.1);
}

/* Titles */
h2 {
  text-align: center;
  color: #333;
  font-size: 22px;
  margin-bottom: 15px;
}

/* Labels */
label {
  display: block;
  margin: 10px 0 5px;
  font-weight: bold;
  color: #444;
}

/* Input Fields */
input {
  width: 100%;
  padding: 10px;
  border: 2px solid #ddd;
  border-radius: 6px;
  font-size: 16px;
  margin-bottom: 10px;
  transition: border-color 0.3s ease-in-out;
}

/* Input Focus Effect */
input:focus {
  border-color: #6a11cb;
  outline: none;
  box-shadow: 0px 0px 5px rgba(106, 17, 203, 0.5);
}

/* Buttons */
button {
  width: 100%;
  background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
  color: white;
  border: none;
  padding: 12px;
  font-size: 18px;
  font-weight: bold;
  border-radius: 30px;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  position: relative;
  overflow: hidden;
}

/* Button Hover Effect */
button::before {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) rotate(45deg);
  width: 0;
  height: 300%;
  background: rgba(255, 255, 255, 0.2);
  transition: width 0.3s ease-in-out;
}

button:hover::before {
  width: 150%;
}

button:hover {
  transform: translateY(-3px);
  box-shadow: 0px 8px 15px rgba(0, 0, 0, 0.3);
}

/* Responsive Design */
@media (max-width: 768px) {
  .container {
    flex-direction: column;
    align-items: center;
  }

  .form-section {
    width: 100%;
  }
}


  </style>
</head>
<body>
  <header>
    <h1>EVO Finance Service</h1>
  </header>

  <!-- Customer Service Button -->
  <a href="#" class="customer-service-btn" target="_blank">
    <i class="fas fa-headset"></i>
  </a>

  <div id="main-content">
    <!-- Section Profil sy Cover -->
    <section class="profile-section">
      <div class="profile-header">
        <div class="cover-photo" id="coverPhoto">
          <img src="cover-placeholder.jpg" alt="Photo de couverture" id="coverImg">
          <button class="upload-button" id="uploadCover"></button>
          <input type="file" id="coverInput" accept="image/*" style="display: none;">
        </div>
        <div class="profile-photo-container">
          <div class="profile-photo" id="profilePhoto">
            <img src="profile-placeholder.jpg" alt="Photo de profil" id="profileImg">
          </div>
          <button class="upload-button" id="uploadProfile"></button>
          <input type="file" id="profileInput" accept="image/*" style="display: none;">
        </div>
      </div>
    </section><br >><br ><br ><br >

    <!-- Section Compte -->
    <section id="mon-compte">
        
        
        
        
        
    
    
    <section >
    <!DOCTYPE html>
<html lang="mg">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Diaporama Mahafatifaty</title>
  <style>
    /* CSS ho an'ny diaporama */
    .diaporama {
      position: relative;
      width: 80%;
      max-width: 600px;
      height: 400px; /* refy mazava ho an'ny container */
      margin: 30px auto;
      border: 2px solid #ccc;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      background: #f9f9f9;
    }
    .diaporama img {
      width: 100%;
      height: 100%;
      object-fit: cover; /* mitazona ny endrika tsara rehefa feno ilay container */
      position: absolute;
      top: 0;
      left: 0;
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }
    .diaporama img.active {
      opacity: 1;
    }
  </style>
</head>
<body>
  <!-- Diaporama misy sary telo azo jerena -->
  <div class="diaporama">
    <img src="Sary1.jpg" alt="Sary 1" class="active">
    <img src="Sary2.jpg" alt="Sary 2">
    <img src="Sary3.jpg" alt="Sary 3">
  </div>

  <script>
    // JavaScript hikirakira ny fiovan'ny sary ao amin'ny diaporama
    const saryList = document.querySelectorAll('.diaporama img');
    let index = 0;

    function manovaSary() {
      saryList[index].classList.remove('active');
      index = (index + 1) % saryList.length;
      saryList[index].classList.add('active');
    }

    // Miova sary isaky ny 3 segondra (3000 miliseconds)
    setInterval(manovaSary, 3000);
  </script>
</body>
</html>
</section >








      <h2>Mon compte</h2>
      <div class="account-info">
        <div class="compte-depot">
          <h3>Solde du dépôt</h3>
          <p id="soldeDepot">0$</p>
        </div>
        <div class="compte-gains">
          <h3>Solde du gains</h3>
          <p id="soldeGains">0$</p>
        </div>
      </div>
    </section>



    <section >
    <!-- Section Liens externes -->
    <section id="extra-sections">
      <a href="https://evo-finance-seven.vercel.app/" target="_blank" class="link-button">Entreprise</a>
      <a href="https://evo-finance-quipe-ivl7.vercel.app/" target="_blank" class="link-button">Gestion d'équipes</a>
      <a href="https://evo-finance-guide.vercel.app/" target="_blank" class="link-button">Guide complet</a>
      <a href="https://evo-finance-bot-f1po.vercel.app/" target="_blank" class="link-button">Besoin d'aide ?</a>
      <a href="https://evo-finance-demande-du-d-p-t.vercel.app/" target="_blank" class="link-button">Dépôt Evo. Fin</a>
      <a href="https://evo-finance-demande-retrait.vercel.app/" target="_blank" class="link-button">Retrait Evo. Fin</a>
      <a href="https://plan-de-travail.vercel.app/" target="_blank" class="link-button">Plan d'investissement</a>
    <!-- Section Transaction -->
    <section id="transaction">
        
        
        
        
        
        
        
        
        
        
      <h2>Transaction</h2>
      <div class="transaction-buttons">
        <button id="btn-depot">Faire un dépôt</button>
        <button id="btn-retrait">Faire un retrait</button>
        <button id="btn-transfert">Faire une transfert d'argent</button>
      </div>
      <div class="transaction-forms">
          
          
          
          
          
          
          
          
          
          
        <!-- Formulaire Dépôt -->
        <form id="form-depot" style="display: none;">
          <h3>Dépôt</h3>
          <label for="depot-montant">Montant:</label>
          <input type="number" id="depot-montant" min="10" placeholder="Minimum 10$" required>
          <label for="adresse-depot">Adresse du dépôt:</label>
          <select id="adresse-depot">
            <option value="P1121911473">P1121911473</option>
            <option value="P1121911473">P1121911473</option>
          </select>
          <button type="button" onclick="copyAdresse()">Copier l'adresse</button>
          <label for="id-transaction">Id de transaction:</label>
          <input type="text" id="id-transaction" required>
          <button type="submit">Valider le dépôt</button>
        </form>

        <!-- Formulaire Retrait -->
        <form id="form-retrait" style="display: none;">
          <h3>Retrait</h3>
          <label for="retrait-montant">Montant à retirer:</label>
          <input type="number" id="retrait-montant" min="1" placeholder="Minimum 1$" required>
          <label for="adresse-retrait">Adresse du retrait (PAYEER UNIQUEMENT):</label>
          <input type="text" id="adresse-retrait" required>
          <button type="submit">Valider le retrait</button>
        </form>

        <!-- Formulaire Transfert d'argent -->
        <form id="form-transfert" style="display: none;">
          <h3>Transfert d'argent</h3>
          <label for="transfert-montant">Montant à transférer:</label>
          <input type="number" id="transfert-montant" min="5" placeholder="Minimum 5$" required>
          <label for="email-utilisateur">Email de l'utilisateur destinataire:</label>
          <input type="email" id="email-utilisateur" required>
          <label for="reception-type">Réception :</label>
          <select id="reception-type" required>
            <option value="depot">Solde du dépôt</option>
            <option value="gains">Solde du gains</option>
          </select>
          <button type="submit">Envoyer</button>
        </form>
      </div>
    </section>
    
    
    
    
    
    
    

    <!-- Section Trading -->
    <section id="trading">
      <h2>Trading</h2>
      <div class="trading-container">
        <button id="btn-trading" class="trading-button">Trading</button>
        <p id="trading-status">Cliquez sur Trading pour commencer</p>
        <div id="notification-trading">
          <p>Le robot EVO FINANCE vous offre <span id="gain-robot">0$</span></p>
          <button id="btn-ajouter-gains">Ajouter au compte du gains</button>
        </div>
      </div>
    </section>

    <!-- Section Historique -->
    <section id="historique">
      <h2>Historique</h2>
      <div id="historique-container">
        <!-- Ireo transaction dia hiseho eto -->
      </div>
    </section>

    <!-- Section Enregistrement CIN -->
    <section id="registration-cin">
        
        
        
        
        
        
        
        
        
        
        
        
      <h2>Enregistrement CIN</h2>
      <form id="form-registration-cin">
        <label for="reg-email">E-mail :</label>
        <input type="email" id="reg-email" required>
        <label for="reg-cin">Numero de CIN :</label>
        <input type="text" id="reg-cin" required>
        <label for="reg-nom">Nom complet :</label>
        <input type="text" id="reg-nom" required>
        <label for="reg-password">Mot de passe :</label>
        <input type="password" id="reg-password" required>
        <button type="submit">Enregistrer</button>
      </form>
    </section>

    <!-- Section Vérification CIN -->
    <section id="verification-cin">
      <h2>Vérification CIN</h2>
      <form id="form-verification-cin">
        <label for="verification-email">E-mail :</label>
        <input type="email" id="verification-email" required>
        <label for="verification-cin-input">Numero de CIN :</label>
        <input type="text" id="verification-cin-input" required>
        <label for="verification-password">Mot de passe :</label>
        <input type="password" id="verification-password" required>
        <button type="submit">Vérifier</button>
      </form>
    </section>
  </div>
  
  
  
  
  
  

  <!-- JavaScript Inline (Firebase, logique, upload, modal) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-analytics.js";
    import { getFirestore, collection, addDoc, doc, updateDoc, setDoc, getDoc, query, where, getDocs } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDbAk8VyG7gfzmmFAFLAnUtUi1XrSNrQQQ",
      authDomain: "evo-finance-service.firebaseapp.com",
      projectId: "evo-finance-service",
      storageBucket: "evo-finance-service.appspot.com",
      messagingSenderId: "231632509264",
      appId: "1:231632509264:web:03cf6b9e2ef75a4f7bb455",
      measurementId: "G-2561NK5LL8"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const db = getFirestore(app);
    const auth = getAuth(app);

    let currentUser = null;
    let soldeDepot = 0;
    let soldeGains = 0;
    let currentGain = 0;

    // Enregistrement CIN
    document.getElementById('form-registration-cin').addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('reg-email').value.trim();
      const cin = document.getElementById('reg-cin').value.trim();
      const nom = document.getElementById('reg-nom').value.trim();
      const password = document.getElementById('reg-password').value;
      if (!email || !cin || !nom || !password) {
        showNotification("Veuillez remplir tous les champs pour l'enregistrement.");
        return;
      }
      try {
        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;
        await setDoc(doc(db, "utilisateurs", user.uid), { email, cin, nom, verified: false, timestamp: new Date() });
        await setDoc(doc(db, "balances", user.uid), { soldeDepot: 0, soldeGains: 0 });
        showNotification("Enregistrement CIN réussi. Veuillez ensuite vérifier votre CIN.");
      } catch (error) {
        console.error("Erreur lors de l'enregistrement CIN: ", error);
        showNotification("Erreur: " + error.message);
      }
    });

    // Vérification CIN
    document.getElementById('form-verification-cin').addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('verification-email').value.trim();
      const cinInput = document.getElementById('verification-cin-input').value.trim();
      const password = document.getElementById('verification-password').value;
      if (!email || !cinInput || !password) {
        showNotification("Veuillez remplir tous les champs.");
        return;
      }
      try {
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;
        const userRef = doc(db, "utilisateurs", user.uid);
        const userSnap = await getDoc(userRef);
        if (userSnap.exists()) {
          const userData = userSnap.data();
          if (userData.cin === cinInput) {
            currentUser = { uid: user.uid, email, cin: cinInput, ...userData };
            await updateDoc(userRef, { verified: true });
            showNotification("Vérification réussie.");
            document.getElementById('main-content').style.display = "block";
            document.getElementById('registration-cin').style.display = "none";
            document.getElementById('verification-cin').style.display = "none";
            loadBalance();
            loadHistorique();
          } else {
            showNotification("Le numéro de CIN ne correspond pas.");
          }
        } else {
          showNotification("Utilisateur introuvable.");
        }
      } catch (error) {
        console.error("Erreur lors de la vérification: ", error);
        showNotification("Erreur: " + error.message);
      }
    });

    async function loadBalance() {
      if (currentUser) {
        const balanceRef = doc(db, "balances", currentUser.uid);
        const balanceSnap = await getDoc(balanceRef);
        if (balanceSnap.exists()) {
          const data = balanceSnap.data();
          soldeDepot = data.soldeDepot || 0;
          soldeGains = data.soldeGains || 0;
        } else {
          await setDoc(balanceRef, { soldeDepot: 0, soldeGains: 0 });
          soldeDepot = 0;
          soldeGains = 0;
        }
        updateBalances();
      }
    }

    async function updateBalances() {
      document.getElementById('soldeDepot').innerText = soldeDepot.toFixed(2) + "$";
      document.getElementById('soldeGains').innerText = soldeGains.toFixed(2) + "$";
      if (currentUser) {
        await setDoc(doc(db, "balances", currentUser.uid), { soldeDepot, soldeGains }, { merge: true });
      }
    }

    function showNotification(message) {
      const notif = document.createElement("div");
      notif.className = "notification";
      notif.innerText = message;
      document.body.appendChild(notif);
      setTimeout(() => { notif.remove(); }, 2000);
    }

    async function addHistorique(type, montant, fee = 0) {
      try {
        await addDoc(collection(db, "historique"), { type, montant, fee, timestamp: new Date(), uid: currentUser.uid });
        loadHistorique();
      } catch (error) {
        console.error("Erreur lors de l'ajout de l'historique: ", error);
      }
    }

    async function loadHistorique() {
      if (currentUser) {
        const histQuery = query(collection(db, "historique"), where("uid", "==", currentUser.uid));
        const histSnapshot = await getDocs(histQuery);
        const histContainer = document.getElementById('historique-container');
        histContainer.innerHTML = "";
        histSnapshot.forEach(doc => {
          const data = doc.data();
          const item = document.createElement('div');
          item.className = "historique-item";
          item.innerText = `${data.type} - Montant: ${data.montant}$ - Frais: ${data.fee}$ - Date: ${data.timestamp.toDate().toLocaleString()}`;
          histContainer.appendChild(item);
        });
      }
    }

    // Gestion des formulaires de transaction
    document.getElementById('btn-depot').addEventListener('click', () => {
      if (!currentUser) {
        showNotification("Veuillez vérifier votre CIN d'abord.");
        return;
      }
      hideAllForms();
      document.getElementById('form-depot').style.display = 'block';
    });
    document.getElementById('btn-retrait').addEventListener('click', () => {
      if (!currentUser) {
        showNotification("Veuillez vérifier votre CIN d'abord.");
        return;
      }
      hideAllForms();
      document.getElementById('form-retrait').style.display = 'block';
    });
    document.getElementById('btn-transfert').addEventListener('click', () => {
      if (!currentUser) {
        showNotification("Veuillez vérifier votre CIN d'abord.");
        return;
      }
      hideAllForms();
      document.getElementById('form-transfert').style.display = 'block';
    });
    function hideAllForms() {
      document.getElementById('form-depot').style.display = 'none';
      document.getElementById('form-retrait').style.display = 'none';
      document.getElementById('form-transfert').style.display = 'none';
    }
    window.copyAdresse = function() {
      const select = document.getElementById('adresse-depot');
      const address = select.value;
      navigator.clipboard.writeText(address).then(() => {
        showNotification("Adresse copiée: " + address);
      });
    };

    // Formulaire Dépôt
    document.getElementById('form-depot').addEventListener('submit', async (e) => {
      e.preventDefault();
      if (!currentUser) {
        showNotification("Veuillez vérifier votre CIN pour effectuer cette opération.");
        return;
      }
      const montant = parseFloat(document.getElementById('depot-montant').value);
      if (montant < 10) {
        showNotification("Le dépôt minimum est de 10$");
        return;
      }
      const adresse = document.getElementById('adresse-depot').value;
      const idTransaction = document.getElementById('id-transaction').value;
      try {
        await addDoc(collection(db, "depots"), {
          montant,
          adresse,
          idTransaction,
          uid: currentUser.uid,
          status: "pending",
          timestamp: new Date()
        });
        showNotification("Demande de dépôt envoyée");
        addHistorique("Dépôt", montant);
      } catch (error) {
        console.error("Erreur lors du dépôt: ", error);
      }
    });

    // Formulaire Retrait
    document.getElementById('form-retrait').addEventListener('submit', async (e) => {
      e.preventDefault();
      if (!currentUser) {
        showNotification("Veuillez vérifier votre CIN pour effectuer cette opération.");
        return;
      }
      const montant = parseFloat(document.getElementById('retrait-montant').value);
      if (montant < 1) {
        showNotification("Le retrait minimum est de 1$");
        return;
      }
      const frais = montant * 0.10; // Frais de 10%
      const total = montant + frais;
      if (soldeGains < total) {
        showNotification("Solde insuffisant pour le retrait.");
        return;
      }
      const adresseRetrait = document.getElementById('adresse-retrait').value;
      try {
        await addDoc(collection(db, "retraits"), {
          montant,
          frais,
          adresseRetrait,
          uid: currentUser.uid,
          status: "pending",
          timestamp: new Date()
        });
        soldeGains -= total; // On déduit uniquement du Solde gains
        await updateBalances();
        showNotification("Demande de retrait envoyée");
        addHistorique("Retrait", montant, frais);
      } catch (error) {
        console.error("Erreur lors du retrait: ", error);
      }
    });

    // Formulaire Transfert d'argent
    document.getElementById('form-transfert').addEventListener('submit', async (e) => {
      e.preventDefault();
      if (!currentUser) {
        showNotification("Veuillez vérifier votre CIN pour effectuer cette opération.");
        return;
      }
      const montant = parseFloat(document.getElementById('transfert-montant').value);
      if (montant < 5) {
        showNotification("Le transfert minimum est de 5$");
        return;
      }
      const frais = montant * 0.05; // Frais de 5%
      const total = montant + frais;
      if (soldeGains < total) {
        showNotification("Solde insuffisant pour le transfert.");
        return;
      }
      const emailUtilisateur = document.getElementById('email-utilisateur').value;
      if (emailUtilisateur === currentUser.email) {
        showNotification("Vous ne pouvez pas effectuer de transfert vers votre propre compte.");
        return;
      }
      const receptionType = document.getElementById('reception-type').value;
      const recipientQuery = query(collection(db, "utilisateurs"), where("email", "==", emailUtilisateur));
      const recipientSnapshot = await getDocs(recipientQuery);
      if (recipientSnapshot.empty) {
        showNotification("Utilisateur non trouvé pour cet email.");
        return;
      }
      const recipientDoc = recipientSnapshot.docs[0];
      const recipientUid = recipientDoc.id;
      soldeGains -= total;
      await updateBalances();
      const recipientBalanceRef = doc(db, "balances", recipientUid);
      const recipientBalanceSnap = await getDoc(recipientBalanceRef);
      let recipientSolde = 0;
      if (recipientBalanceSnap.exists()) {
        recipientSolde = recipientBalanceSnap.data()[receptionType === "depot" ? "soldeDepot" : "soldeGains"] || 0;
      }
      recipientSolde += montant;
      await setDoc(recipientBalanceRef, { [receptionType === "depot" ? "soldeDepot" : "soldeGains"]: recipientSolde }, { merge: true });
      await addDoc(collection(db, "transferts"), {
        montant,
        frais,
        emailUtilisateur,
        receptionType,
        status: "confirmed",
        timestamp: new Date()
      });
      addHistorique("Transfert", montant, frais);
      showNotification("Transfert effectué vers " + emailUtilisateur);
    });

    const tradingButton = document.getElementById('btn-trading');
    const tradingStatus = document.getElementById('trading-status');
    const notificationTrading = document.getElementById('notification-trading');

    tradingButton.addEventListener('click', async () => {
      if (!currentUser) {
        showNotification("Veuillez vérifier votre CIN pour effectuer cette opération.");
        return;
      }
      const balanceRef = doc(db, "balances", currentUser.uid);
      const balanceSnap = await getDoc(balanceRef);
      if (balanceSnap.exists()) {
        const data = balanceSnap.data();
        if (data.lastTrading) {
          const lastTradingTime = data.lastTrading.toDate ? data.lastTrading.toDate() : data.lastTrading;
          const now = new Date();
          if (now - lastTradingTime < 24 * 60 * 60 * 1000) {
            showNotification("Trading déjà effectué. Veuillez patienter 24h.");
            return;
          }
        }
      }
      tradingButton.disabled = true;
      tradingStatus.innerText = "Acheter";
      setTimeout(() => {
        tradingStatus.innerText = "Vendre";
        setTimeout(async () => {
          tradingStatus.innerText = "Tâche terminée";
          if (soldeDepot >= 10 && soldeDepot < 200) {
            currentGain = soldeDepot * 0.025;
          } else if (soldeDepot >= 200 && soldeDepot < 500) {
            currentGain = soldeDepot * 0.026;
          } else if (soldeDepot >= 500) {
            currentGain = soldeDepot * 0.03;
          } else {
            currentGain = 0;
          }
          document.getElementById("gain-robot").innerText = currentGain.toFixed(2) + "$";
          notificationTrading.style.display = "block";
          await setDoc(doc(db, "balances", currentUser.uid), { lastTrading: new Date() }, { merge: true });
        }, 5000);
      }, 5000);
    });

    document.getElementById('btn-ajouter-gains').addEventListener('click', () => {
      if (currentGain > 0) {
        soldeGains += currentGain;
        updateBalances();
        showNotification("Gains ajoutés: " + currentGain.toFixed(2) + "$");
        addHistorique("Gains Trading", currentGain);
        currentGain = 0;
        notificationTrading.style.display = "none";
      } else {
        showNotification("Trading déjà effectué ou aucun gain disponible.");
      }
    });

    updateBalances();
  </script>

  <script>
    function handleFileInput(inputElement, imgElementId, storageKey) {
      const file = inputElement.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const imgElement = document.getElementById(imgElementId);
          imgElement.src = e.target.result;
          try {
            localStorage.setItem(storageKey, e.target.result);
          } catch (error) {
            console.error("Erreur lors de la sauvegarde dans localStorage", error);
          }
        }
        reader.readAsDataURL(file);
      }
    }
    document.addEventListener('DOMContentLoaded', function() {
      const storedProfile = localStorage.getItem('profileImage');
      if (storedProfile) { document.getElementById('profileImg').src = storedProfile; }
      const storedCover = localStorage.getItem('coverImage');
      if (storedCover) { document.getElementById('coverImg').src = storedCover; }
    });
    document.getElementById('uploadCover').addEventListener('click', function() {
      document.getElementById('coverInput').click();
    });
    document.getElementById('coverInput').addEventListener('change', function() {
      handleFileInput(this, 'coverImg', 'coverImage');
    });
    document.getElementById('uploadProfile').addEventListener('click', function() {
      document.getElementById('profileInput').click();
    });
    document.getElementById('profileInput').addEventListener('change', function() {
      handleFileInput(this, 'profileImg', 'profileImage');
    });
    const modal = document.getElementById("modal");
    const modalImg = document.getElementById("modalImg");
    const profilePhoto = document.getElementById("profilePhoto");
    profilePhoto.addEventListener('click', function() {
      modal.style.display = "block";
      modalImg.src = document.getElementById('profileImg').src;
    });
    document.querySelector('.close').addEventListener('click', function() {
      modal.style.display = "none";
    });
    modal.addEventListener('click', function(e) {
      if (e.target === modal) { modal.style.display = "none"; }
    });
  </script>
</body>
</html













<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Description de la Plateforme EVO-FINANCE</title>
  <style>
      
      
      
      

      
      
      
      
      
      
      
    .container {
      background: #fff;
      padding: 40px;
      border-radius: 12px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      max-width: 800px;
      width: 90%;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #2c3e50;
    }
    p {
      line-height: 1.6;
      text-align: justify;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Description de la Plateforme EVO-FINANCE</h1>
    <p>
      EVO-FINANCE est une plateforme de trading intelligent révolutionnaire, reposant sur des algorithmes de trading de haute performance et des technologies d'intelligence artificielle avancées. Conçue pour répondre aux exigences d'un marché financier en constante évolution, elle offre à ses utilisateurs des outils d'analyse en temps réel capables d'identifier et d'exploiter des opportunités d'investissement souvent inaccessibles aux méthodes traditionnelles.
    </p>
    <p>
      Grâce à son système de trading intelligent très exigeant, EVO-FINANCE optimise les portefeuilles d'investissement en évaluant avec précision les risques et en détectant les tendances émergentes. L'interface intuitive et conviviale de la plateforme est spécialement conçue pour satisfaire tant les traders expérimentés que les novices, en proposant des fonctionnalités personnalisables et une navigation fluide. Par ailleurs, l'intégration d'outils de gestion des risques robustes assure une sécurité optimale lors des opérations financières.
    </p>
    <p>
      Pour améliorer encore l'expérience utilisateur et la performance globale de la plateforme, plusieurs axes d'amélioration peuvent être envisagés. Premièrement, l'enrichissement des outils d'analyse par des modules de machine learning prédictif permettrait d'anticiper avec une précision accrue les fluctuations du marché. Deuxièmement, l'intégration de flux d'actualités économiques et financières en temps réel fournirait aux utilisateurs des informations contextuelles essentielles pour affiner leurs stratégies. En outre, l'ajout de fonctionnalités sociales, telles qu'une communauté de traders et des outils collaboratifs, favoriserait le partage de connaissances et renforcerait la dynamique collective. Enfin, l'amélioration continue de l'interface utilisateur, via des tableaux de bord interactifs et des visualisations de données modernes, contribuerait à une expérience d'utilisation optimale et engageante.
    </p>
  </div>
</body>
</html>
>
